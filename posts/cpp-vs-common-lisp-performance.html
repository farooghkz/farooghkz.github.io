<!DOCTYPE html>
<html>
   <head>
      <title>Farooq's Website | C++ vs Common Lisp performance</title>
      <link rel="stylesheet" href="../css/def.css" type="text/css">
      <link rel="stylesheet" href="../css/w3.css" type="text/css">
      <style>
      </style>
      <meta charset="utf-8">
      <meta name="description" content="Farooq's personal Website">
      <meta name="keywords"
      content="Farooq,FarooqKZ,Farooq Karimi Zadeh">
      <meta name="author" content="Farooq Karimi Zadeh">
   </head>

   <body>
        <header class="w3-container w3-teal w3-center">
         <h1>Farooq's Website</h1>
            
         <a href="../index.html">Home</a> |
         <a href="https://notabug.org/farooqkz">Projects</a> |
         <a href="http://fubuntu.crabdance.com:2015/farooqkz">
           Files on fubuntu
         </a> |
         <a href="http://blinuxshell.ir/users/farooqkz/">
           Files on bitcoinshell
         </a>

       </header>
        <section class="w3-container">
        <h3>C++ vs Common Lisp performance</h3>

<p>After I read a small paper named <a href="http://www.iaeng.org/IJCS/issues_v32/issue_4/IJCS_32_4_19.pdf" >How to make Lisp go faster than C</a>
I decided to do some small benchmarking myself with C++ and Common Lisp.
For benchmarking I have written programs which find prime numbers from 2 up to 384460.
All programs were run on my laptop with the following specs and properties:
<img src="farooqs-laptop-specs.png" alt="Farooq&apos;s laptop specs" /></p>

<h4>C++</h4>

<p>Here&apos;s my code in C++:</p>

<pre><code>bool isprime(unsigned long n) {
    if (n &lt; 2) return false;
    for (unsigned long i = 2; i &lt; n; i++) {
        if (n%i == 0) return false;
    }
    return true;
}
int main() {
    for (unsigned long i = 2; i &lt;= 384460; i++) {
        isprime(i);
    }
    return 0;
}</code></pre>

<p>And the time this program took to find all prime numbers in the given range without
optimizing(<code>clang++ prime.cpp</code>):
<code>
real    1m2.907s
user    1m2.816s
sys 0m0.084s
</code>
And with <code>-O3</code> option:
<code>
real    0m54.604s
user    0m54.566s
sys 0m0.008s
</code></p>

<h4>Common Lisp untyped</h4>

<p>Code:
```common-lisp
(defun isprime (n)
  (if (&lt; n 2)
      nil
      (loop for i from 2 to (1- n)
        when (zerop (mod n i))
          return nil
        finally
           (return t))))</p>

<p>(defun main ()
  (loop for i from 2 to 384460 count (isprime i)))</p>

<p>(main)
<code>
And the time it took:
</code>
real    2m0.889s
user    2m0.805s
sys 0m0.078s
```</p>

<h4>Common Lisp typed and optimized</h4>

<p>Code:
```common-lisp
(declaim (optimize (speed 3) (safety 0) (debug 0)))</p>

<p>(defun isprime (n)
  (declare (type fixnum n))
  (if (&lt; n 2)
      nil
      (loop for i fixnum from 2 to (1- n)
        when (zerop (mod n i))
          return nil
        finally
           (return t))))</p>

<p>(defun main ()
  (loop for i fixnum from 2 to 384460 count (isprime i)))</p>

<p>(main)
<code>
And the time it took:
</code>
real    0m59.837s
user    0m59.755s
sys 0m0.070s
```</p>

<p>As you see according to these results CL typed and optimized code is a bit
slower than the C++ version. However someone who helped me a lot in <code>#clschool</code> on
freenode reported that both C++ version and CL typed version ran in 21.6s.</p>

<p><strong>NOTE: I used SBCL for both typed and untyped version</strong></p>

<h4>Thanks to</h4>

<ul>
<li>People in <code>#clschool</code> who helped me.</li>
<li>Didier Verna for their good article</li>
</ul>
 
        </section>
        <footer class="w3-container w3-teal w3-center">
            <a href='../pages/links.html'>External links</a>&nbsp;|&nbsp;<a href='../pages/donate.html'>Donate</a>&nbsp;|&nbsp;<a href='../pages/contact.html'>Contact</a>
            <br>Content is available under
            <a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">
            CC0</a> unless something else was specified.<br>
              This website has been 
              generated using <a href="https://notabug.org/farooqkz/fobil">
              fobil</a>.


             &nbsp;
        </footer>

    </body>
</html>
